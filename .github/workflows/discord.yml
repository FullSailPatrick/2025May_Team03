      - name: Post to Discord
        env:
          WEBHOOK: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          # ————————————————
          # 1) pull in all the GitHub context we need
          EVENT="${{ github.event_name }}"
          REPO="${{ github.repository }}"
          BRANCH="${GITHUB_REF##*/}"
          ACTOR="${{ github.actor }}"
          COMMIT=$(git log -1 --pretty=format:'%h %s')
          LINK="https://github.com/${{ github.repository }}/commit/${{ github.sha }}"

          # ————————————————
          # 2) build the JSON payload based on event type
          if [ "$EVENT" = "push" ]; then
            cat <<EOF > payload.json
{
  "content": ":white_check_mark: Push to \`$REPO\` on \`$BRANCH\` by \`$ACTOR\`
Commit: $COMMIT
$LINK"
}
EOF
          else
            cat <<EOF > payload.json
{
  "content": ":card_index_dividers: Project card \`$EVENT\` in \`$REPO\` by \`$ACTOR\`
Card: $CARD_URL
Column: $COLUMN"
}
EOF
          fi

          # ————————————————
          # 3) debug output so you can see what went out
          echo "=== payload.json ==="
          cat payload.json
          echo "===================="

          # ————————————————
          # 4) send it to Discord
          curl -s -H "Content-Type: application/json" \
               -d @payload.json \
               "$WEBHOOK"
